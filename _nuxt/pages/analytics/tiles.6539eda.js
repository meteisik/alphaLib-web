(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{389:function(t,e,r){"use strict";r(6),r(56),r(8),r(45),r(50),r(25),r(19),r(20),r(4),r(15);function n(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var i=0,n=function(){};return{s:n,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,h=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return l=t.done,t},e:function(t){h=!0,c=t},f:function(){try{l||null==r.return||r.return()}finally{if(h)throw c}}}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r}var c={name:"HeatMapWrapperForAnalytics",components:{"heat-map":r(380).a},props:{id:{type:String,default:"heatmap"},divId:{type:String,default:"heatmap-div"},svgId:{type:String,default:"heatmap-svg-element"},chartHeight:{type:Number,default:100},chartWidth:{type:Number,default:100},flat:{type:Boolean,default:!0},outlined:{type:Boolean,default:!0},hover:{type:Boolean,default:!0},rounded:{type:Boolean,default:!0},maxWidth:{type:String,default:"100%"},label:{type:String,default:"This Amazing HeatMap"},dataset:{type:Array,default:function(){return[]}}},asyncData:function(){return{}},data:function(){return{colorRange:["rgb(255,253,234)","#ff5a08"],meta:{show:!1,info:"Hello this is only a help box!"}}},computed:{heatmapData:function(){var t,e=[],r=n(this.dataset);try{for(r.s();!(t=r.n()).done;){var o,c=t.value,l=n(c.response.hits.hits);try{for(l.s();!(o=l.n()).done;){var h=o.value;e.push({x:c.query,y:h._source.path.virtual,value:h.highlight.content.length})}}catch(t){l.e(t)}finally{l.f()}}}catch(t){r.e(t)}finally{r.f()}return e}},methods:{rectClick:function(t){this.$emit("rectClick",t)}}},l=r(37),h=r(46),d=r.n(h),f=r(419),m=r(373),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-card",{staticClass:"mx-auto",attrs:{outlined:t.outlined,flat:t.flat,hover:t.hover,rounded:t.rounded,"max-width":t.maxWidth}},[r("v-card-title",[t._v("\n    "+t._s(t.label)+"\n  ")]),t._v(" "),r("v-card-text",{attrs:{id:t.divId}},[r("heat-map",{attrs:{"svg-id":t.svgId,width:t.chartWidth,height:t.chartHeight,"color-range":t.colorRange,dataset:t.heatmapData,padding:{top:100,right:2,left:300,bottom:2}},on:{rectClick:t.rectClick}})],1)],1)}),[],!1,null,null,null);e.a=component.exports;d()(component,{VCard:f.a,VCardText:m.c,VCardTitle:m.d})},484:function(t,e,r){"use strict";r.r(e);r(6),r(56),r(8),r(45),r(50),r(25),r(19),r(20),r(4),r(28),r(30),r(58);var n=r(18),o=r(389);r(224),r(109),r(15);function c(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var i=0,n=function(){};return{s:n,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,h=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return c=t.done,t},e:function(t){h=!0,o=t},f:function(){try{c||null==r.return||r.return()}finally{if(h)throw o}}}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r}var h={name:"DocPortionWrapper",components:{"heat-map":r(380).a},props:{id:{type:String,default:"heatmap"},divId:{type:String,default:"heatmap-div"},svgId:{type:String,default:"heatmap-svg-element"},chartHeight:{type:Number,default:100},chartWidth:{type:Number,default:100},flat:{type:Boolean,default:!0},outlined:{type:Boolean,default:!0},hover:{type:Boolean,default:!0},rounded:{type:Boolean,default:!0},maxWidth:{type:String,default:"100%"},label:{type:String,default:"This Amazing HeatMap"},dataset:{type:Array,default:function(){return[]}}},asyncData:function(){return{}},data:function(){return{colorRange:["rgb(255,253,234)","#ff5a08"],meta:{show:!1,info:"Hello this is only a help box!"}}},computed:{heatmapData:function(){var t,e=[],r=c(this.dataset);try{for(r.s();!(t=r.n()).done;){var n=t.value,o=n.response.highlight.content[0].length/10,l=n.response.highlight.content[0].match(new RegExp("[\\s\\S]{1,"+o+"}","g"))||[];for(var i in l)e.push({x:n.query,y:i,value:(l[i].match(/<mark>/g)||[]).length})}}catch(t){r.e(t)}finally{r.f()}return e.reverse()}},methods:{rectClick:function(t){this.$emit("rectClick",t)}}},d=r(37),f=r(46),m=r.n(f),v=r(419),y=r(373),component=Object(d.a)(h,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-card",{staticClass:"mx-auto",attrs:{outlined:t.outlined,flat:t.flat,hover:t.hover,rounded:t.rounded,"max-width":t.maxWidth}},[r("v-card-title",[t._v("\n    "+t._s(t.label)+"\n  ")]),t._v(" "),r("v-card-text",{attrs:{id:t.divId}},[r("heat-map",{attrs:{"svg-id":t.svgId,width:t.chartWidth,height:t.chartHeight,"color-range":t.colorRange,dataset:t.heatmapData,padding:{top:100,right:2,left:50,bottom:2}},on:{rectClick:t.rectClick}})],1)],1)}),[],!1,null,null,null),_=component.exports;function w(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return x(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return x(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var i=0,n=function(){};return{s:n,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,l=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return c=t.done,t},e:function(t){l=!0,o=t},f:function(){try{c||null==r.return||r.return()}finally{if(l)throw o}}}}function x(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r}m()(component,{VCard:v.a,VCardText:y.c,VCardTitle:y.d});var I={name:"PageAnalyticsTiles",components:{DocPortionWrapper:_,HeatMapWrapperForAnalytics:o.a},layout:"withsearchbar",fetch:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r,n,o,c,q,l,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],n=[],o=w(t.queries),e.prev=3,o.s();case 5:if((c=o.n()).done){e.next=17;break}return q=c.value,e.next=9,t.$axios.post("/api/literature/_search",{explain:!0,sort:["_score"],_source:["meta","file","path"],size:100,query:{multi_match:{query:q.query,type:"bool_prefix",fields:["meta","content"]}},highlight:{type:"unified",order:"score",pre_tags:["<mark>"],post_tags:["</mark>"],fields:{content:{number_of_fragments:2e3}}}}).then((function(t){return t.data})).catch((function(t){return console.log(t),{}}));case 9:return l=e.sent,r.push({query:q.query,response:l}),e.next=13,t.$axios.post("/api/literature/_search",{explain:!0,sort:["_score"],_source:["meta","file","path"],size:100,query:{multi_match:{query:q.query,type:"bool_prefix",fields:["meta","content"]}},highlight:{type:"unified",order:"score",pre_tags:["<mark>"],post_tags:["</mark>"],fields:{content:{number_of_fragments:0}}}}).then((function(t){return t.data})).catch((function(t){return console.log(t),{}}));case 13:h=e.sent,n.push({query:q.query,response:h});case 15:e.next=5;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(3),o.e(e.t0);case 22:return e.prev=22,o.f(),e.finish(22);case 25:t.responses=r,t.fullTextResponses=n;case 27:case"end":return e.stop()}}),e,null,[[3,19,22,25]])})))()},data:function(){return{charts:{heatmap:{id:"heatmap",divId:"heatmap-div",svgId:"heatmap-chart-svg-element",label:"Concept intensity across documents",width:300,height:500},heatmap2:{id:"heatmap2",divId:"heatmap2-div",svgId:"heatmap2-chart-svg-element",label:"Positional concept intensity across documents",width:300,height:500}},responses:[],fullTextResponses:[]}},computed:{documents:function(){var t,e=[],r=w(this.fullTextResponses);try{for(r.s();!(t=r.n()).done;){var n,o=w(t.value.response.hits.hits);try{for(o.s();!(n=o.n()).done;){var c=n.value;e.map((function(t){return t._id})).includes(c._id)||e.push(c)}}catch(t){o.e(t)}finally{o.f()}}}catch(t){r.e(t)}finally{r.f()}return e},filteredDocuments:function(){var t=this;return function(e){var r,n=[],o=w(t.fullTextResponses);try{for(o.s();!(r=o.n()).done;){var c,l=r.value,h=w(l.response.hits.hits);try{for(h.s();!(c=h.n()).done;){var d=c.value;d._id===e&&n.push({query:l.query,response:d})}}catch(t){h.e(t)}finally{h.f()}}}catch(t){o.e(t)}finally{o.f()}return n}},queries:function(){return this.$store.state.searchQueries},heatmapHeight:function(){return 500}},mounted:function(){this.resize(),window.addEventListener("resize",this.resize)},methods:{resize:function(){document.getElementById(this.charts.heatmap.divId)&&(this.charts.heatmap.width=300+30*this.responses.length,this.charts.heatmap.height=this.heatmapHeight,document.getElementById(this.charts.heatmap.svgId).setAttribute("width",this.charts.heatmap.width),document.getElementById(this.charts.heatmap.svgId).setAttribute("height",this.charts.heatmap.height));var t,e=w(this.documents);try{for(e.s();!(t=e.n()).done;){var r=t.value;document.getElementById(this.charts.heatmap2.divId+r._id)&&(console.log("found"),this.charts.heatmap2.width=400+20*this.filteredDocuments(r._id).length,this.charts.heatmap2.height=this.heatmapHeight,document.getElementById(this.charts.heatmap2.svgId+r._id).setAttribute("width",this.charts.heatmap2.width),document.getElementById(this.charts.heatmap2.svgId+r._id).setAttribute("height",this.charts.heatmap2.height))}}catch(t){e.e(t)}finally{e.f()}},rectClick:function(t){}}},A=r(172),S=r(364),C=r(449),k=Object(d.a)(I,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-row",{attrs:{align:"center",justify:"start","no-gutters":""}},[r("v-col",{attrs:{cols:"1","align-self":"center"}},[t._v("\n    Queries...\n    "),r("ul",t._l(t.queries,(function(q,i){return r("li",{key:i},[t._v("\n        "+t._s(q.query)+"\n      ")])})),0),t._v(" "),r("v-btn",{on:{click:function(e){return e.stopPropagation(),t.$fetch(e)}}},[t._v("Refresh")])],1),t._v(" "),r("v-col",{attrs:{cols:"11"}},[r("HeatMapWrapperForAnalytics",{staticClass:"mb-2",attrs:{id:t.charts.heatmap.id,"div-id":t.charts.heatmap.divId,"svg-id":t.charts.heatmap.svgId,hover:!1,label:t.charts.heatmap.label,dataset:t.responses,"chart-width":t.charts.heatmap.width,"chart-height":t.charts.heatmap.height,"max-width":"100%"},on:{rectClick:t.rectClick}})],1),t._v(" "),t._l(t.documents,(function(e){return r("v-col",{key:e._id,attrs:{cols:"4"}},[r("DocPortionWrapper",{staticClass:"mb-2",attrs:{id:t.charts.heatmap2.id+e._id,"div-id":t.charts.heatmap2.divId+e._id,"svg-id":t.charts.heatmap2.svgId+e._id,hover:!1,label:e._source.path.virtual,dataset:t.filteredDocuments(e._id),"chart-width":t.charts.heatmap2.width,"chart-height":t.charts.heatmap2.height,"max-width":"100%"},on:{rectClick:t.rectClick}})],1)}))],2)}),[],!1,null,"15715be2",null);e.default=k.exports;m()(k,{VBtn:A.a,VCol:S.a,VRow:C.a})}}]);